// ===== 10. REVERSE - 순서 뒤집기 =====
let revLv,revScore,revSeq,revInput,revShowing;
function initReverse(){revLv=1;revScore=0;revShowing=false;document.getElementById('rev-score').textContent='0점';document.getElementById('rev-level').textContent='Lv.1';initHearts('rev');revNew()}
function revNew(){revShowing=true;revInput=[];const len=revLv+2;revSeq=[];for(let i=0;i<len;i++)revSeq.push(~~(Math.random()*10));document.getElementById('rev-msg').textContent='숫자를 기억하세요!';document.getElementById('rev-input').innerHTML='';const d=document.getElementById('rev-display');d.innerHTML=revSeq.map(()=>'<div class="rev-num hidden">?</div>').join('');let i=0;const iv=setInterval(()=>{if(i>0&&d.children[i-1]){d.children[i-1].classList.add('hidden');d.children[i-1].textContent='?'}if(i<revSeq.length){d.children[i].classList.remove('hidden');d.children[i].textContent=revSeq[i];i++}else{clearInterval(iv);d.querySelectorAll('.rev-num').forEach(n=>{n.classList.add('hidden');n.textContent='?'});revShowing=false;document.getElementById('rev-msg').textContent='거꾸로 입력하세요!';document.getElementById('rev-input').innerHTML=revSeq.map(()=>'<div class="rev-slot"></div>').join('')}},800)}
function revPress(n){if(revShowing)return;const s=document.querySelectorAll('.rev-slot:not(.filled)');if(!s.length)return;s[0].textContent=n;s[0].classList.add('filled');revInput.push(n)}
function revDel(){if(revShowing||!revInput.length)return;revInput.pop();const f=document.querySelectorAll('.rev-slot.filled');if(f.length){const l=f[f.length-1];l.textContent='';l.classList.remove('filled')}}
function revSubmit(){if(revShowing||revInput.length!==revSeq.length)return;const rev=[...revSeq].reverse();const correct=revInput.filter((n,i)=>n===rev[i]).length;const ok=correct===revSeq.length;document.querySelectorAll('.rev-slot').forEach((s,i)=>{s.classList.add(revInput[i]===rev[i]?'ok':'no')});if(correct>0){revScore+=correct*5;setScore('rev-score',revScore)}if(ok){revLv++;document.getElementById('rev-level').textContent='Lv.'+revLv;toast('✓ 정답!');setTimeout(revNew,800)}else{curScore=revScore;setHeartResumeCallback(revNew);if(loseHeart('rev'))return;setTimeout(revNew,800)}}
