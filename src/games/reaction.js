// ===== 3. REACTION - 반응속도 =====
let reactRound,reactTimes,reactState,reactTimeout,reactStart;
function initReaction(){reactRound=0;reactTimes=[];reactState='idle';document.getElementById('react-round').textContent='0/5';document.getElementById('react-score').textContent='준비하세요';reactNext()}
function reactNext(){reactRound++;if(reactRound>5){const avg=Math.round(reactTimes.reduce((a,b)=>a+b,0)/reactTimes.length);let score=0;reactTimes.forEach(ms=>{score+=Math.max(5,Math.round((1000-ms)/10))});showResult(score,'반응속도',[{val:avg+'ms',label:'평균'},{val:Math.min(...reactTimes)+'ms',label:'최고'}],{avg});return}document.getElementById('react-round').textContent=reactRound+'/5';const area=document.getElementById('react-area');area.className='react-area waiting';document.getElementById('react-msg').innerHTML='기다리세요...';reactState='waiting';reactTimeout=setTimeout(()=>{area.className='react-area ready';document.getElementById('react-msg').innerHTML='지금! 터치!';reactState='go';reactStart=Date.now()},1500+Math.random()*3000)}
function reactTap(){if(reactState==='waiting'){clearTimeout(reactTimeout);document.getElementById('react-msg').innerHTML='너무 빨라요!';reactState='idle';scheduleNextQuestion(reactNext,800)}else if(reactState==='go'){const ms=Date.now()-reactStart;reactTimes.push(ms);document.getElementById('react-area').className='react-area result';document.getElementById('react-msg').innerHTML='<div class="react-time">'+ms+'ms</div>';document.getElementById('react-score').textContent='평균: '+Math.round(reactTimes.reduce((a,b)=>a+b,0)/reactTimes.length)+'ms';reactState='idle';scheduleNextQuestion(reactNext,1000)}}
