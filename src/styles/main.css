@import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.min.css');

*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;touch-action:manipulation}
:root{
  --p:#3182F6;--p-dark:#1B64DA;--p-light:#EBF3FE;
  --bg:#F7F8FA;--card:#fff;--text:#191F28;--sub:#8B95A1;--border:#E5E8EB;
  --ok:#1FC58E;--ok-bg:#E8FAF0;--no:#F04452;--no-bg:#FEE7E9;
  --combo:#FF8A00;--purple:#8B5CF6;--pink:#EC4899;
  --r12:12px;--r16:16px;--r20:20px;--r-full:9999px;
  --shadow:0 2px 8px rgba(0,0,0,0.06);
  --font:'Pretendard',-apple-system,BlinkMacSystemFont,'Apple SD Gothic Neo',sans-serif;
}
body{font-family:var(--font);background:var(--bg);color:var(--text);overflow-x:hidden;user-select:none;-webkit-user-select:none}
.app{max-width:480px;margin:0 auto;min-height:100vh;min-height:100dvh}

/* TDS Toast */
.toast{position:fixed;bottom:32px;left:50%;transform:translateX(-50%) translateY(20px);background:rgba(25,31,40,.9);color:#fff;padding:12px 24px;border-radius:12px;font-size:14px;font-weight:600;z-index:999;opacity:0;pointer-events:none;transition:all .3s cubic-bezier(.32,.72,0,1);white-space:nowrap;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);box-shadow:0 4px 16px rgba(0,0,0,.12)}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
.snackbar{position:fixed;top:0;left:0;right:0;z-index:998;transform:translateY(-100%);transition:transform .35s cubic-bezier(.32,.72,0,1);pointer-events:none}
.snackbar.show{transform:translateY(0)}
.snackbar-inner{display:flex;align-items:center;justify-content:center;gap:8px;padding:14px 20px;padding-top:calc(14px + env(safe-area-inset-top));background:var(--p);color:#fff;font-size:14px;font-weight:700;box-shadow:0 4px 12px rgba(49,130,246,.3)}

/* ===== HOME ===== */
.home{padding:16px 16px 120px;overflow-y:auto;height:100vh;height:100dvh}
.home-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
.home-header h1{font-size:22px;font-weight:800}
.home-header-r{display:flex;align-items:center;gap:8px}

.ticket-badge{background:var(--p-light);color:var(--p);padding:6px 12px;border-radius:var(--r-full);font-weight:700;font-size:14px;display:flex;align-items:center;gap:6px;cursor:pointer}

/* Profile Card */
.profile-card{background:var(--card);border-radius:var(--r16);padding:20px;margin-bottom:16px;box-shadow:var(--shadow)}
.pc-content{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px}
.pc-label{font-size:12px;color:var(--sub);margin-bottom:4px}
.pc-value{font-size:32px;font-weight:900}
.pc-value.purple{color:var(--purple)}
.pc-rank-next{font-size:11px;color:var(--p);font-weight:600}

.xp-progress-container{margin-top:12px}
.xp-label{display:flex;justify-content:space-between;font-size:11px;font-weight:600;margin-bottom:6px}
.progress-track{height:4px;background:rgba(25,31,40,.06);border-radius:2px;overflow:hidden}
.progress-fill{height:100%;background:var(--p);transition:width .5s cubic-bezier(.32,.72,0,1)}

/* Point Section */
.point-section{background:var(--card);border-radius:var(--r16);padding:16px;margin-bottom:16px;box-shadow:var(--shadow)}
.section-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.section-title-sm{font-size:14px;font-weight:800}
.point-val{font-size:14px;font-weight:800;color:var(--p)}
.progress-track-sm{height:4px;background:rgba(25,31,40,.06);border-radius:2px;overflow:hidden;margin-bottom:8px}
.progress-fill-blue{height:100%;background:var(--p);transition:width .5s ease}
.point-hint{font-size:12px;color:var(--sub);margin-bottom:12px}

/* Section Title */
.section-title{font-size:18px;font-weight:800;margin:20px 0 10px;display:flex;align-items:center;gap:6px}
.st-sub{font-size:12px;color:var(--sub);font-weight:400;margin-left:auto}

/* Mission Card */
.mission-card{background:var(--card);border-radius:var(--r16);padding:14px;margin-bottom:8px;box-shadow:var(--shadow);display:flex;align-items:center;gap:12px}
.mission-icon{width:40px;height:40px;border-radius:var(--r12);display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0}
.mission-info{flex:1}
.mission-name{font-size:14px;font-weight:600}
.mission-desc{font-size:12px;color:var(--sub);margin-top:1px}
.mission-prog{height:4px;border-radius:2px;background:var(--border);margin-top:6px;overflow:hidden}
.mission-prog-fill{height:100%;border-radius:2px;transition:width .3s}
.mission-check{width:20px;height:20px}
.mission-reward{font-size:11px;font-weight:700;color:var(--p)}

/* Game Grid */
.grid-category-title{font-size:13px;font-weight:700;color:var(--sub);margin:16px 0 8px}
.game-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
.game-card{background:var(--card);border-radius:var(--r16);padding:14px;cursor:pointer;transition:transform .1s;position:relative;box-shadow:var(--shadow);display:flex;align-items:center;gap:10px}
.game-card:active{transform:scale(.97)}
.game-card .gc-icon{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.game-card .gc-icon svg{width:22px;height:22px}
.game-card .gc-info{flex:1;min-width:0}
.game-card .gc-name{font-size:14px;font-weight:700;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.game-card .gc-best{font-size:11px;color:var(--sub)}

/* ===== GAME COMMON ===== */
.screen{display:none}
.screen.active{display:flex;flex-direction:column;height:100vh;height:100dvh}
.g-hdr{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:var(--card);border-bottom:1px solid var(--border)}
.g-hdr .back{font-size:22px;cursor:pointer;background:none;border:none;padding:4px 8px;color:var(--text)}
.g-hdr .g-title{font-size:16px;font-weight:700}
.g-hdr .g-timer{font-size:16px;font-weight:700;color:#3182F6;min-width:40px;text-align:right}
.g-hdr .g-timer.urgent{color:#F04452}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
.g-body{flex:1;display:flex;flex-direction:column;padding:12px 16px;overflow:hidden;justify-content:center}
.g-score{text-align:center;font-size:18px;font-weight:700;position:sticky;top:0;z-index:2;padding:8px 0;background:var(--bg);flex-shrink:0}
.goal-bar{margin:4px 16px 8px;position:relative}
.goal-bar .gb-track{height:8px;border-radius:4px;background:var(--border);overflow:hidden}
.goal-bar .gb-fill{height:100%;border-radius:4px;background:var(--p);transition:width .3s;width:0}
.goal-bar .gb-fill.hot{background:var(--no)}
.goal-bar .gb-fill.done{background:var(--ok)}
.goal-bar .gb-label{display:flex;justify-content:space-between;font-size:12px;color:var(--sub);padding:4px 2px}
.goal-bar .gb-label .gb-target{font-weight:700;color:var(--p)}

/* Hearts */
.hearts{display:flex;gap:2px;align-items:center}
.heart{color:#F04452;transition:all .2s;display:inline-flex}
.heart.lost{opacity:.2;transform:scale(.8)}
.heart-shake{animation:heartShake .4s ease}
@keyframes heartShake{0%,100%{transform:translateX(0)}20%{transform:translateX(-4px)}40%{transform:translateX(4px)}60%{transform:translateX(-2px)}80%{transform:translateX(2px)}}
.heart-break{animation:heartBreak .5s ease forwards}
@keyframes heartBreak{0%{transform:scale(1);opacity:1}50%{transform:scale(1.3);color:var(--no)}100%{transform:scale(.5);opacity:.2}}

/* ===== RESULT UI ===== */
.overlay{display:none;position:fixed;inset:0;background:var(--bg);z-index:100;align-items:flex-start;justify-content:center;overflow-y:auto}
.overlay.active{display:flex}
.result-sheet{background:var(--bg);padding:28px 24px max(24px,env(safe-area-inset-bottom));text-align:center;width:100%;max-width:480px;min-height:100vh;min-height:100dvh;animation:fadeIn .3s ease forwards}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.result-card{background:var(--card);border-radius:var(--r16);padding:24px 20px 16px;margin-bottom:14px;box-shadow:var(--shadow)}
.result-card h3{font-size:18px;margin-bottom:2px}
.r-score{font-size:40px;font-weight:800;color:var(--p);margin:6px 0}
.r-cat{font-size:13px;color:var(--sub);margin-bottom:4px}
.r-badges{display:flex;gap:6px;justify-content:center;flex-wrap:wrap}
.r-badge{padding:4px 12px;border-radius:6px;font-size:13px;font-weight:700;color:#fff}
.r-badge-xp{background:var(--p)}
.r-badge-pt{background:var(--purple)}
.r-stats{display:flex;gap:10px;justify-content:center;margin-bottom:14px}
.r-stat{background:var(--bg);padding:8px 14px;border-radius:var(--r12);text-align:center}
.r-stat .rs-val{font-size:16px;font-weight:700;color:var(--p)}
.r-stat .rs-label{font-size:10px;color:var(--sub)}

/* TDS Button Styles */
.btn{width:100%;padding:16px;border:none;border-radius:16px;font-size:16px;font-weight:700;cursor:pointer;margin-bottom:8px;font-family:var(--font);transition:all .2s ease;position:relative;overflow:hidden}
.btn:active{opacity:.8;transform:scale(.98)}
.btn-primary{background:var(--p);color:#fff}
.btn-weak{background:rgba(49,130,246,.08);color:var(--p)}
.btn-home{background:rgba(25,31,40,.06);color:var(--text)}
.btn-lg{padding:16px;font-size:17px}
.btn-md{padding:12px;font-size:14px}

/* ===== LEVEL UP ===== */
.levelup-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:200;align-items:center;justify-content:center}
.levelup-overlay.active{display:flex}
.levelup-card{background:#fff;border-radius:var(--r20);padding:32px;text-align:center;width:85%;max-width:320px;animation:lvlPop .4s cubic-bezier(.32,.72,0,1)}
@keyframes lvlPop{0%{transform:scale(.8);opacity:0}100%{transform:scale(1);opacity:1}}
.lu-badge{font-size:64px;margin-bottom:12px}
.lu-title{font-size:20px;font-weight:800;margin-bottom:4px}
.lu-desc{font-size:14px;color:var(--sub);margin-bottom:16px}
.lu-unlock{background:var(--p-light);border-radius:var(--r12);padding:10px;font-size:13px;color:var(--p);font-weight:600;margin-bottom:16px}

/* ===== GAME CSS ===== */
.math-problem{display:flex;align-items:center;justify-content:center;gap:12px;padding:24px;background:var(--card);border-radius:var(--r20);transition:background .15s;margin-bottom:14px;box-shadow:var(--shadow)}
.math-problem.ok{background:var(--ok-bg)}.math-problem.no{background:var(--no-bg)}
.m-num{font-size:36px;font-weight:700}
.m-op{font-size:28px;color:var(--p)}.m-eq{font-size:28px;color:var(--sub)}
.m-ans{font-size:36px;font-weight:700;min-width:60px;text-align:center;border-bottom:3px solid var(--p);color:var(--p);padding:2px 8px}
.combo-text{text-align:center;font-size:14px;font-weight:700;color:var(--p);min-height:20px;margin-bottom:8px}
.numpad{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:auto;padding:0 8px 12px;max-width:400px;width:100%;margin-left:auto;margin-right:auto}
.nbtn{padding:18px 0;font-size:24px;font-weight:700;background:var(--card);border:none;border-radius:var(--r12);cursor:pointer;font-family:var(--font);box-shadow:var(--shadow);min-height:56px}
.nbtn:active{background:#E5E8EB;transform:scale(.95)}.nbtn.del{font-size:20px;color:var(--sub)}.nbtn.go{background:var(--p);color:#fff}

.card-grid{display:grid;gap:8px;flex:1;align-content:center}.card-grid.g4{grid-template-columns:repeat(4,1fr)}
.mem-card{aspect-ratio:1;background:var(--p);border-radius:var(--r12);display:flex;align-items:center;justify-content:center;font-size:28px;cursor:pointer;transition:transform .2s,background .3s;box-shadow:var(--shadow)}
.mem-card.flipped,.mem-card.matched{background:var(--card);border:2px solid var(--border)}
.mem-card.matched{background:var(--ok-bg);border-color:var(--ok)}
.mem-card:active{transform:scale(.95)}.mem-card .cf{display:none}.mem-card.flipped .cf,.mem-card.matched .cf{display:block}
.mem-info{text-align:center;padding:8px;font-size:13px;color:var(--sub)}

.seq-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;width:100%;max-width:320px;margin:0 auto;padding:20px 16px}
.seq-cell{aspect-ratio:1;background:var(--card);border:2px solid var(--border);border-radius:var(--r16);display:flex;align-items:center;justify-content:center;font-size:32px;font-weight:800;cursor:pointer;transition:all .2s;box-shadow:var(--shadow);min-height:80px}
.seq-cell.hl{background:var(--p);border-color:var(--p);color:#fff}
.seq-cell.ok{background:var(--ok);border-color:var(--ok);color:#fff}
.seq-cell.no{background:var(--no);border-color:var(--no);color:#fff}
.seq-msg{text-align:center;font-size:15px;font-weight:600;padding:12px;min-height:44px}

.stroop-word{font-size:48px;font-weight:800;text-align:center;padding:28px;margin:12px 0}
.stroop-q{text-align:center;font-size:15px;color:var(--sub);margin-bottom:16px}
.stroop-opts{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
.stroop-opt{padding:16px;border-radius:var(--r12);border:2px solid var(--border);background:var(--card);font-size:17px;font-weight:700;cursor:pointer;text-align:center;font-family:var(--font);box-shadow:var(--shadow)}
.stroop-opt:active{transform:scale(.97)}

.react-area{flex:1;display:flex;align-items:center;justify-content:center;margin:16px 0;border-radius:var(--r20);cursor:pointer;transition:background .3s}
.react-area.waiting{background:var(--no)}.react-area.ready{background:var(--ok)}.react-area.result{background:var(--card);box-shadow:var(--shadow)}
.react-msg{font-size:20px;font-weight:700;color:#fff;text-align:center;padding:20px}
.react-area.result .react-msg{color:var(--text)}.react-time{font-size:52px;font-weight:800;color:var(--p)}

.word-board{display:grid;gap:3px;margin:0;padding:8px 0;grid-template-columns:repeat(6,1fr)}
.wc{aspect-ratio:1;background:var(--card);border:2px solid var(--border);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700;cursor:pointer;transition:all .15s;box-shadow:var(--shadow)}
.wc.selected{background:var(--p-light);border-color:var(--p)}.wc.found{background:var(--ok-bg);border-color:var(--ok);color:var(--ok)}
.word-list{display:flex;flex-wrap:wrap;gap:6px;justify-content:center;padding:8px 0}
.wl-item{padding:4px 12px;border-radius:var(--r-full);font-size:13px;font-weight:600;background:var(--bg);color:var(--sub)}
.wl-item.found{background:var(--ok-bg);color:var(--ok);text-decoration:line-through}

.pat-seq{display:flex;align-items:center;justify-content:center;gap:8px;padding:16px;flex-wrap:wrap}
.pat-item{width:56px;height:56px;border-radius:var(--r12);display:flex;align-items:center;justify-content:center;font-size:28px;background:var(--card);box-shadow:var(--shadow);border:2px solid var(--border)}
.pat-item.q{border:3px dashed var(--p);background:var(--p-light);font-size:24px;color:var(--p)}
.pat-opts{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:auto;padding:8px 0}
.pat-opt{padding:16px;border-radius:var(--r12);background:var(--card);border:2px solid var(--border);font-size:28px;text-align:center;cursor:pointer;box-shadow:var(--shadow);font-family:var(--font)}
.pat-opt:active{transform:scale(.95)}.pat-opt.ok{border-color:var(--ok);background:var(--ok-bg)}.pat-opt.no{border-color:var(--no);background:var(--no-bg)}

.focus-field{flex:1;position:relative;background:var(--card);border-radius:var(--r20);margin:8px 0;overflow:hidden;box-shadow:var(--shadow)}
.focus-target{position:absolute;width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;cursor:pointer;transition:transform .1s;animation:focusPop .2s ease-out}
.focus-target:active{transform:scale(.8)}
.focus-target.good{background:var(--p);box-shadow:0 2px 8px rgba(49,130,246,.3)}
.focus-target.bad{background:var(--p);box-shadow:0 2px 8px rgba(49,130,246,.3)}
.focus-target.bonus{background:var(--p);box-shadow:0 2px 8px rgba(49,130,246,.3);animation:focusPop .2s ease-out,bonusPulse 1s infinite}
@keyframes focusPop{from{transform:scale(0)}to{transform:scale(1)}}
@keyframes bonusPulse{0%,100%{box-shadow:0 2px 8px rgba(255,138,0,.3)}50%{box-shadow:0 2px 16px rgba(255,138,0,.5)}}
.focus-legend{display:flex;gap:16px;justify-content:center;padding:8px;font-size:12px;color:var(--sub);font-weight:600}

/* Number Touch */
.nt-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:5px;margin:8px 0}
.nt-cell{aspect-ratio:1;background:var(--p);color:#fff;border-radius:var(--r12);display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:800;cursor:pointer;transition:all .15s;box-shadow:var(--shadow)}
.nt-cell:active{transform:scale(.9)}.nt-cell.done{background:var(--ok-bg);color:var(--ok);pointer-events:none;font-size:16px}

/* Rhythm */
.rhy-pads{display:grid;grid-template-columns:repeat(2,1fr);gap:14px;margin:auto 0;padding:0 16px}
.rhy-pad{aspect-ratio:1;border-radius:var(--r20);cursor:pointer;background:var(--pc);opacity:.5;box-shadow:var(--shadow);transition:all .2s;border:3px solid rgba(0,0,0,.08)}
.rhy-pad:active{transform:scale(.9)}.rhy-pad.lit{opacity:1;transform:scale(1.05);border-color:rgba(255,255,255,.4);box-shadow:0 0 30px var(--pc)}

/* RPS */
.rps-enemy{font-size:48px;font-weight:900;text-align:center;padding:24px 0;color:var(--p)}
.rps-q{text-align:center;font-size:16px;font-weight:700;color:var(--p);padding:8px}
.rps-opts{display:flex;gap:12px;justify-content:center;padding:16px}
.rps-btn{flex:1;padding:20px;border-radius:var(--r16);border:2px solid var(--border);background:var(--card);font-size:20px;font-weight:800;cursor:pointer;transition:all .15s;box-shadow:var(--shadow)}
.rps-btn:active{transform:scale(.9)}.rps-btn.ok{border-color:var(--ok);background:var(--ok-bg)}.rps-btn.no{border-color:var(--no);background:var(--no-bg)}

/* Odd One */
.odd-grid{display:grid;gap:4px;margin:8px 0}
.odd-cell{aspect-ratio:1;background:var(--card);border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:700;cursor:pointer;box-shadow:var(--shadow);transition:all .15s;border:2px solid var(--border);user-select:none}
.odd-cell:active{transform:scale(.9)}.odd-cell.ok{border-color:var(--ok);background:var(--ok-bg)}.odd-cell.no{border-color:var(--no);background:var(--no-bg)}

/* Compare */
.cmp-nums{display:flex;align-items:center;justify-content:center;gap:20px;padding:30px 0}
.cmp-n{font-size:48px;font-weight:900;color:var(--p);min-width:100px;text-align:center;padding:24px 16px;border-radius:var(--r16);background:var(--card);box-shadow:var(--shadow);border:2px solid var(--border);cursor:pointer;transition:all .2s}.cmp-n:active{transform:scale(.95)}
.cmp-vs{font-size:20px;font-weight:700;color:var(--sub)}
.cmp-opts{display:flex;gap:10px;padding:0 16px}
.cmp-btn{flex:1;padding:16px;border-radius:var(--r12);border:2px solid var(--border);background:var(--card);font-size:16px;font-weight:700;cursor:pointer;box-shadow:var(--shadow)}
.cmp-btn:active{transform:scale(.95)}

/* Bulb */
.bulb-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin:auto 0;padding:0 24px}
.bulb-item{aspect-ratio:1;border-radius:50%;background:var(--card);border:3px solid var(--border);cursor:pointer;transition:all .25s;box-shadow:var(--shadow)}
.bulb-item.on{background:#FBBF24;border-color:#F59E0B;box-shadow:0 0 24px rgba(251,191,36,.6),0 0 48px rgba(251,191,36,.2)}.bulb-item:active{transform:scale(.9)}

/* Color Mix */
.cmx-q{text-align:center;padding:16px;font-size:16px;font-weight:600}
.cmx-opts{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;padding:0 16px}
.cmx-opt{padding:20px;border-radius:var(--r16);border:3px solid var(--border);cursor:pointer;text-align:center;transition:all .15s;box-shadow:var(--shadow)}
.cmx-opt:active{transform:scale(.95)}.cmx-opt.ok{border-color:var(--ok)}.cmx-opt.no{border-color:var(--no)}

/* Word Complete */
.wc-word{text-align:center;font-size:36px;font-weight:800;letter-spacing:8px;padding:24px 0;color:var(--text)}
.wc-hint{text-align:center;font-size:14px;color:var(--sub);padding:0 0 16px}
.wc-opts{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;padding:0 16px}
.wc-opt{padding:16px;border-radius:var(--r12);border:2px solid var(--border);background:var(--card);font-size:20px;font-weight:700;text-align:center;cursor:pointer;box-shadow:var(--shadow)}
.wc-opt:active{transform:scale(.95)}.wc-opt.ok{border-color:var(--ok);background:var(--ok-bg)}.wc-opt.no{border-color:var(--no);background:var(--no-bg)}

/* Timing */
.tm-bar{position:relative;height:60px;background:var(--card);border-radius:var(--r-full);margin:30px 16px;overflow:hidden;box-shadow:var(--shadow);border:2px solid var(--border)}
.tm-target{position:absolute;height:100%;background:var(--ok-bg);border-radius:var(--r-full)}
.tm-cursor{position:absolute;top:0;width:4px;height:100%;background:var(--p);border-radius:2px;transition:none}

/* Match Pair */
.mp-cols{display:flex;gap:12px;padding:8px}
.mp-col{flex:1;display:flex;flex-direction:column;gap:8px}
.mp-item{padding:14px 10px;border-radius:var(--r12);border:2px solid var(--border);background:var(--card);font-size:14px;font-weight:600;text-align:center;cursor:pointer;transition:all .15s;box-shadow:var(--shadow)}
.mp-item:active{transform:scale(.95)}.mp-item.sel{border-color:var(--p);background:var(--p-light)}.mp-item.ok{border-color:var(--ok);background:var(--ok-bg);pointer-events:none}.mp-item.no{border-color:var(--no);background:var(--no-bg)}

/* Head Count */
.hc-stage{position:relative;height:180px;margin:12px 0;overflow:hidden;background:linear-gradient(180deg,#E8F4FD 0%,#F0F4F8 100%);border-radius:var(--r16)}
.hc-counter{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-size:32px;font-weight:900;color:var(--p);z-index:3;opacity:.12}
.hc-person{position:absolute;bottom:12px;width:36px;height:36px;z-index:4;transition:none}
.hc-person img{width:100%;height:100%}
.hc-person.enter{animation:hcEnter .7s ease forwards}
.hc-person.exit{animation:hcExit .7s ease forwards}
@keyframes hcEnter{0%{left:-40px;opacity:1}60%{left:calc(50% - 18px);opacity:1}100%{left:calc(50% - 18px);opacity:0;transform:scale(.4)}}
@keyframes hcExit{0%{left:calc(50% - 18px);opacity:0;transform:scale(.4)}40%{left:calc(50% - 18px);opacity:1;transform:scale(1)}100%{left:calc(100% + 8px);opacity:1}}
.hc-log{text-align:center;padding:4px;font-size:15px;font-weight:600;min-height:28px;color:var(--sub)}
.hc-opts{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;padding:0 16px}
.hc-opt{padding:14px 0;border-radius:var(--r12);border:2px solid var(--border);background:var(--card);font-size:20px;font-weight:800;text-align:center;cursor:pointer;box-shadow:var(--shadow)}
.hc-opt:active{transform:scale(.95)}.hc-opt.ok{border-color:var(--ok);background:var(--ok-bg)}.hc-opt.no{border-color:var(--no);background:var(--no-bg)}

/* Pyramid */
.pyr-grid{display:flex;flex-direction:column;align-items:center;gap:6px;padding:16px}
.pyr-row{display:flex;gap:6px}
.pyr-cell{width:56px;height:44px;border-radius:var(--r12);display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:800;background:var(--card);border:2px solid var(--border);box-shadow:var(--shadow)}
.pyr-cell.blank{border:2px dashed var(--p);background:var(--p-light);cursor:pointer;color:var(--p)}
.pyr-cell.blank:active{transform:scale(.95)}.pyr-cell.fixed{background:var(--bg)}
.pyr-input{display:flex;gap:6px;justify-content:center;padding:8px;flex-wrap:wrap}
.pyr-btn{width:44px;height:40px;border-radius:var(--r12);border:2px solid var(--border);background:var(--card);font-size:16px;font-weight:700;cursor:pointer}

/* Max Number */
.mx-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin:12px 0}
.mx-cell{padding:16px 0;border-radius:var(--r12);background:var(--card);border:2px solid var(--border);font-size:22px;font-weight:800;text-align:center;cursor:pointer;box-shadow:var(--shadow)}
.mx-cell:active{transform:scale(.95)}.mx-cell.ok{border-color:var(--ok);background:var(--ok-bg)}.mx-cell.no{border-color:var(--no);background:var(--no-bg)}

/* Sign Find */
.sf-eq{text-align:center;font-size:42px;font-weight:900;padding:32px 0;color:var(--text);letter-spacing:4px}
.sf-opts{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;padding:0 16px}
.sf-opt{padding:18px 0;border-radius:var(--r12);border:2px solid var(--border);background:var(--card);font-size:24px;font-weight:800;text-align:center;cursor:pointer;box-shadow:var(--shadow)}
.sf-opt:active{transform:scale(.95)}.sf-opt.ok{border-color:var(--ok);background:var(--ok-bg)}.sf-opt.no{border-color:var(--no);background:var(--no-bg)}

/* Coin Count */
.cc-coins{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;padding:20px 16px;min-height:100px}
.cc-coin{width:56px;height:56px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:800;color:#fff;box-shadow:inset 0 2px 4px rgba(255,255,255,.3),0 2px 4px rgba(0,0,0,.2)}
.cc-opts{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;padding:0 16px}
.cc-opt{padding:16px;border-radius:var(--r12);border:2px solid var(--border);background:var(--card);font-size:18px;font-weight:700;text-align:center;cursor:pointer;box-shadow:var(--shadow)}
.cc-opt:active{transform:scale(.95)}.cc-opt.ok{border-color:var(--ok);background:var(--ok-bg)}.cc-opt.no{border-color:var(--no);background:var(--no-bg)}

/* Clock */
.clk-opts{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;padding:0 16px}
.clk-opt{padding:14px;border-radius:var(--r12);border:2px solid var(--border);background:var(--card);font-size:18px;font-weight:700;text-align:center;cursor:pointer;box-shadow:var(--shadow)}
.clk-opt:active{transform:scale(.95)}.clk-opt.ok{border-color:var(--ok);background:var(--ok-bg)}.clk-opt.no{border-color:var(--no);background:var(--no-bg)}

/* Word Memory */
.wm-display{text-align:center;padding:16px;min-height:60px}
.wm-word{font-size:32px;font-weight:800;color:var(--p);animation:wmFade .5s ease-out}
@keyframes wmFade{from{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}
.wm-opts{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;padding:0 16px}
.wm-opt{padding:16px;border-radius:var(--r12);border:2px solid var(--border);background:var(--card);font-size:16px;font-weight:700;text-align:center;cursor:pointer;box-shadow:var(--shadow)}
.wm-opt:active{transform:scale(.95)}.wm-opt.ok{border-color:var(--ok);background:var(--ok-bg)}.wm-opt.no{border-color:var(--no);background:var(--no-bg)}

/* Block Count */
.bc-opts{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;padding:0 16px}
.bc-opt{padding:14px 0;border-radius:var(--r12);border:2px solid var(--border);background:var(--card);font-size:20px;font-weight:800;text-align:center;cursor:pointer;box-shadow:var(--shadow)}
.bc-opt:active{transform:scale(.95)}.bc-opt.ok{border-color:var(--ok);background:var(--ok-bg)}.bc-opt.no{border-color:var(--no);background:var(--no-bg)}

.rotate-q{text-align:center;padding:8px;margin-bottom:8px;font-size:14px;font-weight:600}
.rotate-original{display:flex;justify-content:center;padding:16px}
.rotate-original canvas{border-radius:var(--r16);box-shadow:var(--shadow);background:var(--card)}
.rotate-opts{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;padding:8px 0;margin-top:auto}
.rotate-opt{display:flex;justify-content:center;padding:12px;border-radius:var(--r16);border:2px solid var(--border);background:var(--card);cursor:pointer;box-shadow:var(--shadow)}
.rotate-opt:active{transform:scale(.97)}.rotate-opt.ok{border-color:var(--ok);background:var(--ok-bg)}.rotate-opt.no{border-color:var(--no);background:var(--no-bg)}
.rotate-opt canvas{border-radius:var(--r12)}

.rev-display{display:flex;justify-content:center;gap:8px;padding:16px;flex-wrap:wrap}
.rev-num{width:48px;height:56px;border-radius:var(--r12);background:var(--p);color:#fff;display:flex;align-items:center;justify-content:center;font-size:24px;font-weight:700;box-shadow:0 2px 8px rgba(49,130,246,.2)}
.rev-num.hidden{background:var(--border);color:transparent}
.rev-input{display:flex;justify-content:center;gap:8px;padding:8px;flex-wrap:wrap}
.rev-slot{width:48px;height:56px;border-radius:var(--r12);border:2px dashed var(--border);display:flex;align-items:center;justify-content:center;font-size:24px;font-weight:700;color:var(--p)}
.rev-slot.filled{border-style:solid;border-color:var(--p);background:var(--p-light)}
.rev-slot.ok{border-color:var(--ok);background:var(--ok-bg);color:var(--ok)}
.rev-slot.no{border-color:var(--no);background:var(--no-bg);color:var(--no)}

/* Leaderboard */
.lb-container { flex: 1; overflow-y: auto; padding: 16px 20px; }
.lb-list { background: var(--card); border-radius: var(--r16); overflow: hidden; box-shadow: var(--shadow); }
.lb-item { display: flex; align-items: center; padding: 16px 20px; border-bottom: 1px solid var(--border); transition: background .2s; }
.lb-item:active { background: #F9FAFB; }
.lb-item:last-child { border-bottom: none; }
.lb-rank { width: 32px; font-size: 15px; font-weight: 800; color: var(--sub); }
.lb-name { flex: 1; font-size: 16px; font-weight: 700; color: var(--text); }
.lb-score { font-size: 16px; font-weight: 800; color: var(--p); }
.rank-1 .lb-rank { color: #FFD700; font-size: 20px; }
.rank-2 .lb-rank { color: #ADB5BD; font-size: 18px; }
.rank-3 .lb-rank { color: #D97706; font-size: 17px; }

/* Overlays */
.heart-overlay, .levelup-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:1200;align-items:center;justify-content:center;padding:24px;backdrop-filter:blur(4px)}
.heart-overlay.active, .levelup-overlay.active{display:flex}
.heart-card, .levelup-card{background:var(--card);border-radius:28px;padding:32px 24px;text-align:center;width:100%;max-width:320px;box-shadow:0 20px 48px rgba(0,0,0,0.2);animation:pop .4s cubic-bezier(0.18, 0.89, 0.32, 1.28)}
@keyframes pop{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}

.hide{display:none!important}
