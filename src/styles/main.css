@import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.min.css');

*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;touch-action:manipulation}
:root{
  --p:#3182F6;--p-dark:#1B64DA;--p-light:#EBF3FE;
  --bg:#F2F4F6;--card:#fff;--text:#191F28;--sub:#4E5933;--sub-text:#8B95A1;--border:#E5E8EB;
  --ok:#1FC58E;--ok-bg:#E8FAF0;--no:#F04452;--no-bg:#FEE7E9;
  --combo:#FF8A00;--purple:#8B5CF6;--pink:#EC4899;
  --r12:12px;--r16:16px;--r20:20px;--r-full:9999px;
  --shadow:0 2px 4px rgba(0,0,0,0.04), 0 12px 24px rgba(0,0,0,0.04);
  --shadow-sm:0 2px 8px rgba(0,0,0,0.04);
  --font:'Pretendard',-apple-system,BlinkMacSystemFont,'Apple SD Gothic Neo',sans-serif;
}
body{font-family:var(--font);background:var(--bg);color:var(--text);overflow-x:hidden;user-select:none;-webkit-user-select:none;line-height:1.5}
.app{max-width:480px;margin:0 auto;min-height:100vh;min-height:100dvh;background:var(--card)}

/* TDS Button Styles */
.btn{display:inline-flex;align-items:center;justify-content:center;border:none;border-radius:12px;font-weight:700;cursor:pointer;transition:all .2s;white-space:nowrap;font-family:inherit}
.btn-primary{background:var(--p);color:#fff}
.btn-primary:active{background:var(--p-dark);transform:scale(.97)}
.btn-weak{background:var(--p-light);color:var(--p)}
.btn-weak:active{transform:scale(.97)}
.btn-lg{padding:16px 24px;font-size:17px;width:100%}
.btn-md{padding:12px 20px;font-size:15px}
.btn-sm{padding:8px 14px;font-size:13px}
.btn-home{background:#E5E8EB;color:var(--text);width:100%}

/* Toast & Snackbar */
.toast{position:fixed;bottom:48px;left:50%;transform:translateX(-50%) translateY(20px);background:rgba(25,31,40,0.85);color:#fff;padding:14px 24px;border-radius:16px;font-size:15px;font-weight:600;z-index:999;opacity:0;pointer-events:none;transition:all .4s cubic-bezier(.18,.89,.32,1.28);white-space:nowrap;backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);box-shadow:0 8px 32px rgba(0,0,0,0.2)}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
.snackbar{position:fixed;top:0;left:0;right:0;z-index:998;transform:translateY(-100%);transition:transform .35s cubic-bezier(.32,.72,0,1);pointer-events:none}
.snackbar.show{transform:translateY(0)}
.snackbar-inner{display:flex;align-items:center;justify-content:center;gap:8px;padding:14px 20px;padding-top:calc(14px + env(safe-area-inset-top));background:var(--p);color:#fff;font-size:14px;font-weight:700;box-shadow:0 4px 12px rgba(49,130,246,.3)}

/* Home Screen */
.home{background:var(--bg);height:100vh;height:100dvh;display:flex;flex-direction:column}
.home-header{padding:12px 20px;display:flex;justify-content:space-between;align-items:center;background:var(--card)}
.header-left{display:flex;align-items:center;gap:10px}
.header-icon{width:32px;height:32px;border-radius:8px}
.header-title{font-size:20px;font-weight:800;letter-spacing:-0.3px}
.home-scroll-content{flex:1;overflow-y:auto;padding:16px 20px 100px}

/* Ticket Badge */
.ticket-badge{background:var(--p-light);color:var(--p);padding:6px 12px;border-radius:var(--r-full);font-weight:700;font-size:14px;display:flex;align-items:center;gap:6px;cursor:pointer}
.emoji-sm{width:16px;height:16px}
.emoji-md{width:20px;height:20px;vertical-align:-4px}

/* Profile Card */
.profile-card{background:var(--card);border-radius:24px;padding:24px;margin-bottom:16px;box-shadow:var(--shadow)}
.pc-content{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:20px}
.pc-label{font-size:13px;color:var(--sub-text);font-weight:600;margin-bottom:4px}
.pc-value{font-size:32px;font-weight:900;line-height:1.2}
.pc-value.purple{color:var(--purple)}
.pc-rank-next{font-size:12px;color:var(--p);font-weight:600;margin-top:2px}

/* Progress Bars */
.xp-progress-container{margin-top:12px}
.xp-label{display:flex;justify-content:space-between;font-size:12px;font-weight:600;margin-bottom:8px}
.xp-label .sub{color:var(--sub-text)}
.progress-track{height:8px;background:#F2F4F6;border-radius:4px;overflow:hidden}
.progress-fill{height:100%;background:var(--p);border-radius:4px;transition:width .6s cubic-bezier(0.34, 1.56, 0.64, 1)}

/* Point Section */
.point-section{background:var(--card);border-radius:24px;padding:24px;margin-bottom:16px;box-shadow:var(--shadow)}
.section-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.section-title-sm{font-size:16px;font-weight:800}
.point-val{font-size:16px;font-weight:800;color:var(--p)}
.progress-track-sm{height:6px;background:#F2F4F6;border-radius:3px;overflow:hidden;margin-bottom:12px}
.progress-fill-blue{height:100%;background:var(--p);border-radius:3px;transition:width .5s ease}
.point-hint{font-size:13px;color:var(--sub-text);margin-bottom:16px}

/* Section Title */
.section-title{font-size:18px;font-weight:800;margin:24px 0 12px;display:flex;align-items:center;gap:8px}
.st-sub{margin-left:auto;font-size:14px;color:var(--p);background:var(--p-light);padding:2px 8px;border-radius:6px}

/* Mission Card */
.mission-card{background:var(--card);border-radius:20px;padding:16px;margin-bottom:12px;box-shadow:var(--shadow-sm);display:flex;align-items:center;gap:16px;cursor:pointer;transition:transform .2s}
.mission-card:active{transform:scale(.97)}
.mission-icon{width:44px;height:44px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0}
.mission-info{flex:1}
.mission-name{font-size:15px;font-weight:700;color:var(--text)}
.mission-desc{font-size:13px;color:var(--sub-text);margin-top:2px}
.mission-prog{height:6px;border-radius:3px;background:#F2F4F6;margin-top:10px;overflow:hidden}
.mission-prog-fill{height:100%;border-radius:3px;transition:width .4s ease}
.mission-check{width:24px;height:24px;flex-shrink:0}
.mission-reward{font-size:12px;font-weight:700;color:var(--p)}

/* Game Grid */
.grid-category-title{font-size:14px;font-weight:700;color:var(--sub-text);margin:24px 0 12px;padding-left:4px}
.game-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.game-card{background:var(--card);border-radius:20px;padding:16px;cursor:pointer;transition:all .2s;position:relative;box-shadow:var(--shadow-sm);display:flex;align-items:center;gap:12px}
.game-card:active{transform:scale(.96);background:#F9FAFB}
.game-card .gc-icon{width:40px;height:40px;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.game-card .gc-icon svg{width:22px;height:22px}
.game-card .gc-info{flex:1;min-width:0}
.game-card .gc-name{font-size:14px;font-weight:700;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.game-card .gc-best{font-size:12px;color:var(--sub-text);margin-top:2px;font-weight:500}

/* Game Common UI */
.screen{display:none}
.screen.active{display:flex;flex-direction:column;height:100vh;height:100dvh;background:var(--bg)}
.g-hdr{display:flex;justify-content:space-between;align-items:center;padding:12px 20px;background:var(--card);border-bottom:1px solid var(--border)}
.g-hdr .back{font-size:24px;cursor:pointer;background:none;border:none;padding:4px;color:var(--text);display:flex;align-items:center}
.g-hdr .g-title{font-size:17px;font-weight:800;letter-spacing:-0.3px}
.g-hdr .g-timer{font-size:17px;font-weight:800;color:var(--p);min-width:50px;text-align:right;font-variant-numeric:tabular-nums}
.g-hdr .g-timer.urgent{color:var(--no);animation:pulse 0.5s infinite}

.g-body{flex:1;display:flex;flex-direction:column;padding:20px;overflow:hidden;justify-content:center;position:relative}
.g-score{text-align:center;font-size:24px;font-weight:900;color:var(--text);margin-bottom:16px}

.goal-bar{margin:0 auto 24px;width:100%;max-width:320px}
.goal-bar .gb-label{display:flex;justify-content:space-between;font-size:12px;font-weight:700;color:var(--sub-text);margin-bottom:6px}
.goal-bar .gb-track{height:8px;background:rgba(0,0,0,0.05);border-radius:4px;overflow:hidden}
.goal-bar .gb-fill{height:100%;background:var(--p);transition:width .4s cubic-bezier(0.34, 1.56, 0.64, 1)}
.goal-bar .gb-fill.hot{background:var(--combo)}
.goal-bar .gb-fill.done{background:var(--ok)}

/* Hearts */
.hearts{display:flex;gap:4px;align-items:center}
.heart{color:var(--no);display:inline-flex;transition:transform .2s}
.heart.lost{color:var(--border);transform:scale(0.8);opacity:0.5}
.heart-shake{animation:shake 0.4s ease}

/* Workout Card */
.workout-card{background:var(--card);border-radius:24px;padding:24px;margin-bottom:16px;box-shadow:var(--shadow);border:none}
.wk-header{text-align:center;margin-bottom:20px}
.wk-header-sub{font-size:13px;color:var(--p);font-weight:700;margin-bottom:4px;display:block}
.wk-header-title{font-size:20px;font-weight:800}
.wk-games{display:flex;gap:10px;margin-bottom:20px}
.wk-game{flex:1;display:flex;flex-direction:column;align-items:center;gap:8px;padding:16px 8px;border-radius:16px;background:var(--bg);position:relative;transition:all .2s}
.wk-game.current{background:var(--p-light);box-shadow:inset 0 0 0 2px var(--p)}
.wk-game .wk-icon{width:28px;height:28px;color:var(--p);display:flex;align-items:center;justify-content:center}
.wk-game .wk-icon svg{width:100%;height:100%}
.wk-game .wk-name{font-size:12px;font-weight:700;text-align:center;color:var(--text)}
.wk-game .wk-score{font-size:11px;font-weight:700;color:var(--p);margin-top:2px}
.wk-game .wk-check{position:absolute;top:8px;right:8px;width:16px;height:16px}
.wk-progress-container{margin-bottom:20px}
.wk-progress-track{height:6px;background:#F2F4F6;border-radius:3px;overflow:hidden}
.wk-progress-fill{height:100%;background:var(--p);border-radius:3px;transition:width .5s ease}
.wk-bonus-box{text-align:center;margin-top:16px;font-size:12px;color:var(--sub-text);font-weight:600}
.wk-bonus-box b{color:var(--ok)}

/* Workout Transition */
.wk-transition{display:none;position:fixed;inset:0;background:var(--card);z-index:1000;flex-direction:column;align-items:center;justify-content:center;padding:24px}
.wk-transition.active{display:flex}
.wkt-progress{font-size:15px;color:var(--p);font-weight:800;margin-bottom:24px;background:var(--p-light);padding:4px 12px;border-radius:var(--r-full)}
.wkt-icon{width:64px;height:64px;margin-bottom:16px;display:flex;align-items:center;justify-content:center}
.wkt-icon svg{width:100%;height:100%}
.wkt-name{font-size:24px;font-weight:900;margin-bottom:8px}
.wkt-desc{font-size:15px;color:var(--sub-text);margin-bottom:40px;text-align:center}

/* Leaderboard */
.lb-container { flex: 1; overflow-y: auto; padding: 16px 20px; }
.lb-list { background: var(--card); border-radius: 24px; overflow: hidden; box-shadow: var(--shadow-sm); }
.lb-item { display: flex; align-items: center; padding: 16px 20px; border-bottom: 1px solid var(--border); transition: background .2s; }
.lb-item:active { background: #F9FAFB; }
.lb-item:last-child { border-bottom: none; }
.lb-rank { width: 32px; font-size: 15px; font-weight: 800; color: var(--sub-text); }
.lb-name { flex: 1; font-size: 16px; font-weight: 700; color: var(--text); }
.lb-score { font-size: 16px; font-weight: 800; color: var(--p); }
.rank-1 .lb-rank { color: #FFD700; font-size: 20px; }
.rank-2 .lb-rank { color: #ADB5BD; font-size: 18px; }
.rank-3 .lb-rank { color: #D97706; font-size: 17px; }

/* Result Screen */
.overlay{display:none;position:fixed;inset:0;background:var(--bg);z-index:1100;align-items:flex-start;justify-content:center;overflow-y:auto}
.overlay.active{display:flex}
.result-sheet{background:var(--bg);padding:32px 24px max(32px,env(safe-area-inset-bottom));text-align:center;width:100%;max-width:480px;min-height:100vh;min-height:100dvh;animation:sheetSlideIn 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28)}
@keyframes sheetSlideIn{from{transform:translateY(100%)}to{transform:translateY(0)}}
.result-card{background:var(--card);border-radius:24px;padding:32px 20px;margin-bottom:16px;box-shadow:var(--shadow)}
.result-card h3{font-size:18px;font-weight:800;color:var(--sub-text);margin-bottom:8px}
.r-score{font-size:56px;font-weight:900;color:var(--p);line-height:1;margin-bottom:12px}
.r-cat{font-size:15px;color:var(--sub-text);font-weight:600;margin-bottom:20px}
.r-badges{display:flex;gap:8px;justify-content:center;margin-bottom:24px;flex-wrap:wrap}
.r-badge{padding:6px 14px;border-radius:10px;font-size:13px;font-weight:700;display:inline-flex;align-items:center;gap:4px}
.r-badge-xp{background:var(--p-light);color:var(--p)}
.r-badge-pt{background:var(--ok-bg);color:var(--ok)}
.r-stats{display:flex;gap:12px;justify-content:center;margin-bottom:24px}
.r-stat{flex:1;background:var(--bg);padding:12px 8px;border-radius:16px;text-align:center}
.r-stat .rs-val{font-size:18px;font-weight:800;color:var(--text);display:block}
.r-stat .rs-label{font-size:11px;color:var(--sub-text);font-weight:600;margin-top:2px}
.btn-group{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:12px}

/* Overlays */
.heart-overlay, .levelup-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:1200;align-items:center;justify-content:center;padding:24px;backdrop-filter:blur(4px)}
.heart-overlay.active, .levelup-overlay.active{display:flex}
.heart-card, .levelup-card{background:var(--card);border-radius:28px;padding:32px 24px;text-align:center;width:100%;max-width:320px;box-shadow:0 20px 48px rgba(0,0,0,0.2);animation:pop .4s cubic-bezier(0.18, 0.89, 0.32, 1.28)}

@keyframes pop{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-4px)}75%{transform:translateX(4px)}}

/* Game Specific Styles */
.math-problem{display:flex;align-items:center;justify-content:center;gap:12px;padding:32px 24px;background:var(--card);border-radius:24px;transition:all .2s;margin-bottom:20px;box-shadow:var(--shadow-sm)}
.math-problem.ok{background:var(--ok-bg);box-shadow:inset 0 0 0 2px var(--ok)}
.math-problem.no{background:var(--no-bg);box-shadow:inset 0 0 0 2px var(--no)}
.m-num{font-size:40px;font-weight:900;color:var(--text)}
.m-op{font-size:28px;font-weight:800;color:var(--p)}
.m-eq{font-size:28px;font-weight:800;color:var(--sub-text)}
.m-ans{font-size:40px;font-weight:900;color:var(--p);min-width:60px;text-align:center;border-bottom:4px solid var(--p-light)}

.numpad{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;padding:10px 0}
.nbtn{padding:18px;border-radius:16px;border:none;background:var(--card);font-size:22px;font-weight:800;cursor:pointer;box-shadow:var(--shadow-sm);transition:all .1s}
.nbtn:active{transform:scale(.95);background:#F9FAFB}
.nbtn.del{color:var(--no);background:var(--no-bg)}
.nbtn.go{background:var(--p);color:#fff}

.seq-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin:20px auto;width:fit-content}
.seq-cell{width:80px;height:80px;background:var(--card);border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:24px;font-weight:800;cursor:pointer;box-shadow:var(--shadow-sm);transition:all .2s;border:2px solid var(--border)}
.seq-cell.hl{background:var(--p);color:#fff;border-color:var(--p);transform:scale(1.05)}
.seq-cell.ok{background:var(--ok);color:#fff;border-color:var(--ok)}
.seq-cell.no{background:var(--no);color:#fff;border-color:var(--no)}

.stroop-word{font-size:56px;font-weight:900;text-align:center;padding:40px 20px;margin:12px 0}
.stroop-opts{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.stroop-opt{padding:20px;border-radius:20px;border:none;background:var(--card);font-size:18px;font-weight:800;cursor:pointer;box-shadow:var(--shadow-sm);transition:all .2s}
.stroop-opt:active{transform:scale(.96)}

.react-area{flex:1;display:flex;align-items:center;justify-content:center;margin:20px 0;border-radius:32px;cursor:pointer;transition:all .3s}
.react-area.waiting{background:#FF4B4B}
.react-area.ready{background:#00D084}
.react-area.result{background:var(--card);box-shadow:var(--shadow)}
.react-msg{font-size:22px;font-weight:800;color:#fff;text-align:center;line-height:1.4}
.react-area.result .react-msg{color:var(--text)}
.react-time{font-size:64px;font-weight:900;color:var(--p)}

.word-board{display:grid;gap:3px;margin:0;padding:8px 0;grid-template-columns:repeat(6,1fr)}
.wc{aspect-ratio:1;background:var(--card);border:2px solid var(--border);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700;cursor:pointer;transition:all .15s;box-shadow:var(--shadow)}
.wc.selected{background:var(--p-light);border-color:var(--p)}.wc.found{background:var(--ok-bg);border-color:var(--ok);color:var(--ok)}
.word-list{display:flex;flex-wrap:wrap;gap:6px;justify-content:center;padding:8px 0}
.wl-item{padding:4px 12px;border-radius:var(--r-full);font-size:13px;font-weight:600;background:var(--bg);color:var(--sub)}
.wl-item.found{background:var(--ok-bg);color:var(--ok);text-decoration:line-through}

.pat-seq{display:flex;align-items:center;justify-content:center;gap:8px;padding:16px;flex-wrap:wrap}
.pat-item{width:56px;height:56px;border-radius:var(--r12);display:flex;align-items:center;justify-content:center;font-size:28px;background:var(--card);box-shadow:var(--shadow);border:2px solid var(--border)}
.pat-item.q{border:3px dashed var(--p);background:var(--p-light);font-size:24px;color:var(--p)}
.pat-opts{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:auto;padding:8px 0}
.pat-opt{padding:16px;border-radius:var(--r12);background:var(--card);border:2px solid var(--border);font-size:28px;text-align:center;cursor:pointer;box-shadow:var(--shadow);font-family:var(--font)}
.pat-opt:active{transform:scale(.95)}.pat-opt.ok{border-color:var(--ok);background:var(--ok-bg)}.pat-opt.no{border-color:var(--no);background:var(--no-bg)}

.focus-field{flex:1;position:relative;background:var(--card);border-radius:var(--r20);margin:8px 0;overflow:hidden;box-shadow:var(--shadow)}
.focus-target{position:absolute;width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;cursor:pointer;transition:transform .1s;animation:focusPop .2s ease-out}
.focus-target:active{transform:scale(.8)}
.focus-target.good{background:var(--p);box-shadow:0 2px 8px rgba(49,130,246,.3)}
.focus-target.bad{background:var(--p);box-shadow:0 2px 8px rgba(49,130,246,.3)}
.focus-target.bonus{background:var(--p);box-shadow:0 2px 8px rgba(49,130,246,.3);animation:focusPop .2s ease-out,bonusPulse 1s infinite}
@keyframes focusPop{from{transform:scale(0)}to{transform:scale(1)}}
@keyframes bonusPulse{0%,100%{box-shadow:0 2px 8px rgba(255,138,0,.3)}50%{box-shadow:0 2px 16px rgba(255,138,0,.5)}}

.hide{display:none !important}
